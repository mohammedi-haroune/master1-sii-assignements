%arara: pdflatex
\documentclass[•]{article}

\usepackage{../../TP0/style}

\begin{document}
\def\reportnumber{1}
\input{../../TP0/front_page}
\section{Création des tablespaces et des utilusateurs}
\subsection{Créer deux TableSpaces \texttt{INTERVENTION\_TBS} et \texttt{INTERVENTION\_TempTBS}}
\subsubsection{Requête}
\begin{sql}
CREATE TABLESPACE INTERVENTION_TBS
DATAFILE 'INTERVENTION_TBS.DAT'
SIZE 100M
AUTOEXTEND ON
ONLINE;

CREATE TEMPORARY TABLESPACE INTERVENTION_tempTBS
TEMPFILE 'INTERVENTION_tempTBS.DAT'
SIZE 100M
AUTOEXTEND ON;
\end{sql}
\subsubsection{Résultat}
\begin{sql}
Tablespace created.
Tablespace created.
\end{sql}
\subsection{Créer un utilisateur \texttt{DBAINTERVENTION} en lui attribuant les deux tablespaces créés précédemment}
\subsubsection{Requête}
\begin{sql}
CREATE USER DBAINTERVENTION
IDENTIFIED BY DBAINTERVENTION
DEFAULT TABLESPACE INTERVENTION_TBS
TEMPORARY TABLESPACE INTERVENTION_tempTBS;
\end{sql}
\subsubsection{Résultat}
\begin{sql}
User created.
\end{sql}
\subsection{Donner tous les privilèges à cet utilisateur.}
\subsubsection{Requête}
\begin{sql}
GRANT ALL PRIVILEGES TO DBAINTERVENTION;
\end{sql}
\subsubsection{Résultat}
\begin{sql}
Grant succeeded.
\end{sql}
\section{Langage de définition de données}
\subsection{Créer les relations de base avec toutes les contraintes d’intégrité}
\subsubsection{Requête}
\begin{sql}
CREATE TABLE CLIENT
(
NUMCLIENT INTEGER,
CIV VARCHAR2(40),
PRENOMCLIENT VARCHAR2(40),
NOMCLIENT VARCHAR2(40),
DATENAISSANCE DATE,
ADRESSE VARCHAR2(100),
TELPROF VARCHAR2(40),
TELPRIV VARCHAR2(40),
FAX VARCHAR2(40),
CONSTRAINT PK_CLIENT PRIMARY KEY (NUMCLIENT)
);

CREATE TABLE EMPLOYE
(
NUMEMPLOYE INTEGER,
PRENOMEMP VARCHAR2(40),
NOMEMP VARCHAR2(40),
CATEGORIE VARCHAR2(40),
SALAIRE REAL,
CONSTRAINT PK_EMPLOYE PRIMARY KEY (NUMEMPLOYE),
CONSTRAINT CH_EMPLOYE CHECK (CATEGORIE IN ('MECANICIEN' , 'ASSISTANT'))
);

CREATE TABLE MARQUE (
NUMMARQUE INTEGER,
MARQUE VARCHAR2(40),
PAYS VARCHAR2(40),
CONSTRAINT PK_MARQUE PRIMARY KEY (NUMMARQUE)
);

CREATE TABLE MODELE (
NUMMODELE INTEGER,
NUMMARQUE INTEGER,
MODELE VARCHAR2(40),
CONSTRAINT PK_MODELE PRIMARY KEY (NUMMODELE),
CONSTRAINT FK_MODELE_MARQUE FOREIGN KEY (NUMMARQUE) REFERENCES MARQUE(NUMMARQUE)
);

CREATE TABLE VEHICULE (
NUMVEHICULE INTEGER,
NUMCLIENT INTEGER,
NUMMODELE INTEGER,
NUMIMMAT INTEGER,
ANNEE VARCHAR2(4),
CONSTRAINT PK_VEHICULE PRIMARY KEY (NUMVEHICULE),
CONSTRAINT FK_VEHICULE_CLIENT FOREIGN KEY (NUMCLIENT) REFERENCES CLIENT(NUMCLIENT),
CONSTRAINT FK_VEHICULE_MODELE FOREIGN KEY (NUMMODELE) REFERENCES MODELE(NUMMODELE)
);

CREATE TABLE INTERVENTIONS (
NUMINTERVENTION INTEGER,
NUMVEHICULE INTEGER,
TYPEINTERVENTION VARCHAR2(40),
DATEDEBINTERV DATE,
DATEFININTERV DATE,
COUTINTERV REAL,
CONSTRAINT PK_INTERVENTIONS PRIMARY KEY (NUMINTERVENTION),
CONSTRAINT FK_INTERVENTIONS_VEHICULE FOREIGN KEY (NUMVEHICULE) REFERENCES VEHICULE(NUMVEHICULE)
);

CREATE TABLE INTERVENANT
(
NUMINTERVENTION INTEGER,
NUMEMPLOYE INTEGER,
DATEDEBUT DATE,
DATEFIN DATE,
CONSTRAINT PK_INTERVENANT PRIMARY KEY (NUMINTERVENTION, NUMEMPLOYE),
CONSTRAINT FK_INTERVENANT_EMPLOYE FOREIGN KEY (NUMEMPLOYE)REFERENCES EMPLOYE,
CONSTRAINT FK_INTERVENANT_INTERVENTIONS FOREIGN KEY (NUMINTERVENTION) REFERENCES INTERVENTIONS
);
\end{sql}
\subsubsection{Résultat}
\begin{sql}
Table created.
Table created.
Table created.
Table created.
Table created.
Table created.
Table created.
\end{sql}
\subsection{Ajouter l’attribut \texttt{DATEINSTALLATION} de type Date dans la relation \texttt{EMPLOYE}}
\subsubsection{Requête}
\begin{sql}
ALTER TABLE EMPLOYE ADD DATEINSTALLATION DATE NULL;
\end{sql}
\subsubsection{Résultat}
\begin{sql}
Table altered.
\end{sql}
\subsection{Ajouter la contrainte not null pour les attributs \texttt{CATEGORIE}, \texttt{SALAIRE} de la relation \texttt{EMPLOYE}}
\subsubsection{Requête}

\subsubsection{Résultat}
\begin{sql}
Table altered.
\end{sql}
\subsection{Modifier la longueur de l’attribut \texttt{PRENOMEMP} (agrandir, réduire)}
\subsubsection{Requête}
\begin{sql}
ALTER TABLE EMPLOYE MODIFY PRENOMEMP VARCHAR2(20);
ALTER TABLE EMPLOYE MODIFY PRENOMEMP VARCHAR2(50);
\end{sql}
\subsubsection{Résultat}
\begin{sql}
Table altered.
Table altered.
\end{sql}
\subsection{Supprimer la colonne \texttt{DATEINSTALLATION} dans la table \texttt{EMPLOYE}. Vérifier la suppression}
\subsubsection{Requête}
\begin{sql}
ALTER TABLE EMPLOYE DROP COLUMN DATEINSTALLATION;
\end{sql}
\subsubsection{Résultat}
\begin{sql}
Table altered.
\end{sql}
\subsubsection{Vérification}
\begin{sql}
SELECT COLUMN_NAME FROM USER_TAB_COLUMNS WHERE TABLE_NAME = 'CLIENT';

COLUMN_NAME                                                                     
------------------------------                                                  
NUMCLIENT                                                                       
CIV                                                                             
PRENOMCLIENT                                                                    
NOMCLIENT                                                                       
DATENAISSANCE                                                                   
ADRESSE                                                                         
TELPROF                                                                         
TELPRIV                                                                         
FAX                                                                             

9 rows selected.
\end{sql}
\subsection{Renommer la colonne \texttt{ADRESSE} dans la table \texttt{CLIENT} par \texttt{ADRESSECLIENT}. Vérifier}
\subsubsection{Requête}
\begin{sql}
ALTER TABLE CLIENT RENAME COLUMN ADRESSE TO ADRESSECLIENT;
\end{sql}
\subsubsection{Résultat}
\begin{sql}
Table altered.
\end{sql}
\subsubsection{Vérification}
\begin{sql}
SELECT COLUMN_NAME FROM USER_TAB_COLUMNS WHERE TABLE_NAME = 'CLIENT';

COLUMN_NAME                                                                     
------------------------------                                                  
NUMCLIENT                                                                       
CIV                                                                             
PRENOMCLIENT                                                                    
NOMCLIENT                                                                       
DATENAISSANCE                                                                   
ADRESSECLIENT                                                                   
TELPROF                                                                         
TELPRIV                                                                         
FAX                                                                             

9 rows selected.
\end{sql}
\subsection{Ajouter la contrainte suivante : Date de début d’intervention doit être inferieur à la date de fin d’intervention}
\subsubsection{Requête}
\begin{sql}
ALTER TABLE INTERVENTIONS ADD CHECK (DATEDEBINTERV < DATEFININTERV);
\end{sql}
\subsubsection{Résultat}
\begin{sql}
Table altered.
\end{sql}

\section{Langage de manipulation de données}
\subsection{Remplir toutes les tables par les instances représentées ci-dessus, quels sont les problèmes rencontrés.}
\subsection{Supposons que le salaire de l’employé BADI Hatem est augmenté par 5000DA Que faut-il faire ?}
\subsection{Pour les interventions de mois de Février, ajouter 5 cinq jours à la date de début. Désactiver la contrainte}
pour autoriser la modification. Réactiver la contrainte.
\subsection{Supprimer toutes les véhicules de modèle Série 5. Quels sont les problèmes rencontrés.}
\section{Langage d’interrogation de données}
\subsection{Lister les modèles et leur marque.}
\subsection{Lister les véhicules sur lesquels, il y a au moins une intervention.}
\subsection{Quelle est la durée moyenne d’une intervention?}
\subsection{Donner le montant global des interventions dont le coût d’intervention est supérieur à 30000 DA?}


\end{document}